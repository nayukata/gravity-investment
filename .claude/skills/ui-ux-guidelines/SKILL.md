---
name: ui-ux-guidelines
description: アクセシブルで高速、そして心地よいUIを構築するための簡潔なルール集。意思決定の際は MUST（必須）／SHOULD（推奨）／NEVER（禁止） を指針とすること
---

# UI/UX ガイドライン

## インタラクション（Interactions）

### キーボード操作

- **MUST**： [WAI-ARIA APG](https://www.w3.org/WAI/ARIA/apg/patterns/) に準拠したフルキーボード対応
- **MUST**： フォーカスリングを可視化（`:focus-visible`、`:focus-within` と組み合わせ）
- **MUST**： フォーカス管理（トラップ、移動、復帰）をAPGパターンに従って実装

### タップ領域と入力

- **MUST**： ヒットターゲットは24px以上（モバイルは44px以上）。見た目が24px未満ならヒット領域を拡張
- **MUST**： モバイルの `<input>` フォントサイズは16px以上、または次の `<meta>` タグを指定
  ```html
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
  />
  ```
- **NEVER**： ブラウザのズーム機能を無効化すること
- **MUST**： `touch-action: manipulation` を設定してダブルタップズームを防止し、`-webkit-tap-highlight-color` をデザインに合わせる

### 入力フォームの挙動

- **MUST**： ハイドレーション安全な入力（フォーカス・値を失わない）
- **NEVER**： `<input>` / `<textarea>` で貼り付けをブロック
- **MUST**： ローディング中のボタンはスピナーを表示し、元のラベルを保持
- **MUST**： Enterキーでフォーカス中の入力を送信。`<textarea>`では⌘/Ctrl+Enterで送信、Enterで改行
- **MUST**： リクエスト開始までは送信ボタンを有効のままにし、開始後に無効化・スピナー表示・冪等キー使用
- **MUST**： 入力中にブロックしない。自由入力を許可し、検証は後で行う
- **MUST**： 不完全なフォーム送信も許可してエラーメッセージを表示
- **MUST**： エラーはフィールドの近くに表示し、送信時には最初のエラーにフォーカス
- **MUST**： 適切な `autocomplete`、`name`、`type`、`inputmode` を設定
- **SHOULD**： メール・コード・ユーザー名にはスペルチェックを無効化
- **SHOULD**： プレースホルダーは省略記号で終え、例を示す（例：`+1 (123) 456-7890`、`sk-012345…`）
- **MUST**： 未保存変更がある場合はナビゲーション前に警告
- **MUST**： パスワードマネージャー・2FA対応。ワンタイムコードの貼り付けを許可
- **MUST**： テキスト拡張などで生じる末尾の空白をトリミング
- **MUST**： チェックボックスやラジオボタンにデッドゾーンを作らない（ラベルと入力が一体の広い領域を持つ）

### 状態とナビゲーション

- **MUST**： URLが状態を反映（フィルタ・タブ・ページネーションなど）。[nuqs](https://nuqs.vercel.app/) 等のライブラリ推奨
- **MUST**： 戻る／進むでスクロール位置を復元
- **MUST**： リンクは本物のリンクであること（`<a>` / `<Link>` を使い、Cmd/Ctrl/中クリック対応）

### フィードバック

- **SHOULD**： 楽観的UI（レスポンス後に再整合、失敗時はエラー表示とUndo）
- **MUST**： 破壊的操作は確認またはUndo可能に
- **MUST**： トーストやバリデーションには `aria-live="polite"`
- **SHOULD**： “…” は後続アクションを開く項目に使用（例：「名前を変更…」）

### タッチ・ドラッグ・スクロール

- **MUST**： 寛容なインタラクション（広いターゲット、明確な操作感）
- **MUST**： ツールチップは最初遅延、以降のグループ内は即時
- **MUST**： モーダルやドロワー内で `overscroll-behavior: contain` を設定
- **MUST**： ドラッグ中はテキスト選択を無効化し、対象やコンテナに `inert` を設定
- **MUST**： 見た目がクリック可能なら、実際にクリックできるようにする

### 自動フォーカス

- **SHOULD**： デスクトップでは主要入力が1つの場合のみ自動フォーカスを使用。モバイルではレイアウトシフトを避けるため基本禁止

---

## アニメーション（Animation）

- **MUST**： `prefers-reduced-motion` に対応（簡易モードを提供）
- **SHOULD**： CSS ＞ Web Animations API ＞ JSライブラリの順で採用
- **MUST**： `transform` と `opacity` のみアニメーション対象に。`top/left/width/height` は避ける
- **SHOULD**： アニメーションは原因や結果を明確にするため、または意図的な喜びを加えるために使う
- **SHOULD**： 変化内容（距離・大きさ・トリガー）に合わせてイージングを選択
- **MUST**： アニメーションは中断可能で、ユーザー操作によって制御可能
- **MUST**： `transform-origin` は物理的な動きの起点に合わせる

---

## レイアウト（Layout）

- **SHOULD**： 視覚的整列を優先（±1pxの調整も許容）
- **MUST**： グリッド／ベースライン／エッジ／光学中心に意図的に揃える。偶然の位置ずれは禁止
- **SHOULD**： アイコンとテキストのバランス（線幅・サイズ・間隔・色）
- **MUST**： モバイル・ノートPC・ウルトラワイドで検証（ウルトラワイドは50%ズームで確認）
- **MUST**： セーフエリアを考慮（`env(safe-area-inset-*)`）
- **MUST**： 不要なスクロールバーやオーバーフローを防止

---

## コンテンツとアクセシビリティ（Content & Accessibility）

- **SHOULD**： ツールチップよりインラインヘルプを優先
- **MUST**： スケルトンは最終コンテンツと同じ形状にしてレイアウトシフトを防ぐ
- **MUST**： `<title>` は現在のコンテキストに一致
- **MUST**： 行き止まりを作らず、常に次のアクションや回復手段を提供
- **MUST**： 空／密／エラー状態を設計
- **SHOULD**： カーブ付き引用符（“ ”）を使用、孤立行（ウィドウ／オーファン）を避ける
- **MUST**： 数値比較には等幅数字（`font-variant-numeric: tabular-nums` または Geist Mono 等）
- **MUST**： 状態を色だけで表現しない（アイコン＋テキスト併用）
- **MUST**： スキーマをそのまま表示しない（ラベル省略でもアクセシブルネームは存在）
- **MUST**： 省略記号は `…`（三点リーダ）を使用
- **MUST**： 見出しリンク用に `scroll-margin-top` 設定、“スキップリンク”を設け、正しい階層構造の `<h1–h6>` 使用
- **MUST**： ユーザー生成コンテンツに強い設計（短文〜長文対応）
- **MUST**： 日時・数値・通貨はロケール対応
- **MUST**： 正確な `aria-label`、装飾要素は `aria-hidden`、Accessibility Tree で検証
- **MUST**： アイコンのみボタンには説明的な `aria-label`
- **MUST**： まずネイティブ要素（`button`, `a`, `label`, `table`など）を使用し、必要時のみARIAを追加
- **SHOULD**： ナビゲーションロゴの右クリックでブランドアセットを表示
- **MUST**： 不可分スペース（`&nbsp;`）を使って語句をつなぐ  
  例：`10&nbsp;MB`, `⌘&nbsp;+&nbsp;K`, `Vercel&nbsp;SDK`

---

## パフォーマンス（Performance）

- **SHOULD**： iOS低電力モード・macOS Safariでテスト
- **MUST**： 正確な計測（拡張機能による実行時間の歪みを防ぐ）
- **MUST**： 再レンダーを監視・最小化（React DevTools / React Scan）
- **MUST**： CPU・ネットワーク制限下でプロファイル
- **MUST**： レイアウトの読み書きをバッチ化、再フロー／再描画を抑制
- **MUST**： `POST/PATCH/DELETE` のレスポンスは500ms未満を目標
- **SHOULD**： アンコントロールド入力を使用し、制御ループを軽量化（入力1回あたりのコスト削減）
- **MUST**： 大量リストは仮想化（例：`virtua`）
- **MUST**： 折りたたみ領域（above the fold）画像のみプリロードし、残りは遅延読み込み
- **MUST**： 画像に明示的な寸法または予約領域を設定してCLS（Cumulative Layout Shift）防止

---

## デザイン（Design）

- **SHOULD**： 層状のシャドウ（環境光＋直接光）
- **SHOULD**： 半透明ボーダー＋シャドウでエッジを鮮明に
- **SHOULD**： 子要素の角丸は親以下、同心円的に設計
- **SHOULD**： 境界線・影・テキストの色調を背景に合わせる（色相整合）
- **MUST**： カラーブラインド対応の配色を使用（アクセシブルチャート）
- **MUST**： コントラスト基準を満たす。WCAG 2より [APCA](https://www.myndex.com/APCA/) 推奨
- **MUST**： `:hover` / `:active` / `:focus` 時にコントラストを強化
- **SHOULD**： ブラウザUIと背景を調和させる
- **SHOULD**： グラデーションのバンディングを回避（必要に応じてマスク使用）
